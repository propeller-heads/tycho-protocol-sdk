substreams_yaml_path: ./substreams.yaml
protocol_system: "cowamm"
# Contract balance of LP Token does not correlate with what we are tracking (LP Token supply)
# so we skip balance check so we don't get token balance mismatch in tests
skip_balance_check: true
initialized_accounts:
  # - "0xf76c421bAb7df8548604E60deCCcE50477C10462" # factory address
  # - "0x9bd702e05b9c97e4a4a3e47df1e0fe7a0c26d2f1"
  # - "0xfec04c31b6099ce76c4c5d6d754a34141884fd91"
protocol_type_names:
  - "cowamm_pool"
module_name: "map_protocol_changes"
tests:
  - name: test_pool_creation
    start_block: 20479340
    stop_block:  20522100
    expected_components:

      - id: "0xf8F5B88328DFF3d19E5f4F11A9700293Ac8f638F" #BAL/WETH
        tokens:
          - "0xba100000625a3754423978a60c9317c58a424e3D"
          - "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2" 
          - "0xf8F5B88328DFF3d19E5f4F11A9700293Ac8f638F"
        static_attributes: 
           address: "0xf8F5B88328DFF3d19E5f4F11A9700293Ac8f638F"
           token_a: "0xba100000625a3754423978a60c9317c58a424e3D"
           token_b: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
           lp_token: "0xf8F5B88328DFF3d19E5f4F11A9700293Ac8f638F"
           weight_a: "0x0de0b6b3a7640000" #50
           weight_b: "0x0de0b6b3a7640000" #50
           fee: "0x0"
        creation_tx: "0x4dca0db2ac7cf0d5b8cf97cd6b2365d8aa59d0df5b29b1d3e59bc02432143b60"
        skip_simulation: false
        skip_execution: true 

      - id: "0xf706c50513446d709f08d3e5126cd74fb6bFDA19" #AAVE/WETH
        tokens:
          - "0x7Fc66500c84A76Ad7e9c93437bFc5Ac33E2DDaE9"
          - "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2" 
          - "0xf706c50513446d709f08d3e5126cd74fb6bFDA19"
        static_attributes: 
           address: "0xf706c50513446d709f08d3e5126cd74fb6bFDA19"
           token_a: "0x7Fc66500c84A76Ad7e9c93437bFc5Ac33E2DDaE9" 
           token_b: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
           lp_token: "0xf706c50513446d709f08d3e5126cd74fb6bFDA19"
           weight_a: "0x0de0b6b3a7640000" #50
           weight_b: "0x0de0b6b3a7640000" #50
           fee: "0x0"
        creation_tx: "0x218f6657a0ea1865c51beb55b3bd99ccd0826bd668f9e78096ff3b1f88822d43"
        skip_simulation: false
        skip_execution: true 

      - id: "0x4359a8Ea4c353d93245c0B6b8608A28Bb48A05e2" #ARB/WETH
        tokens:
          - "0x4359a8Ea4c353d93245c0B6b8608A28Bb48A05e2"
          - "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
          - "0xb50721bcf8d664c30412cfbc6cf7a15145234ad1" 
        static_attributes: 
           address: "0x4359a8Ea4c353d93245c0B6b8608A28Bb48A05e2"
           token_a: "0xb50721bcf8d664c30412cfbc6cf7a15145234ad1" 
           token_b: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
           lp_token: "0x4359a8Ea4c353d93245c0B6b8608A28Bb48A05e2"
           weight_a: "0x0de0b6b3a7640000" #50
           weight_b: "0x0de0b6b3a7640000" #50
           fee: "0x0"
        creation_tx: "0x59cb7792d348a6fc3ba19acba2292f0e836ddef786da21f7c8bba7c0cbbe5f25"
        skip_simulation: false
        skip_execution: true 

      - id: "0x9bd702e05b9c97e4a4a3e47df1e0fe7a0c26d2f1" #COW/wstETH
        tokens:
          - "0xdef1ca1fb7fbcdc777520aa7f396b4e015f497ab"
          - "0x7f39C581F595B53c5cb19bD0b3f8dA6c935E2Ca0" 
          - "0x9bd702e05b9c97e4a4a3e47df1e0fe7a0c26d2f1"
        static_attributes: 
           address: "0x9bd702e05b9c97e4a4a3e47df1e0fe7a0c26d2f1"
           token_a: "0x7f39C581F595B53c5cb19bD0b3f8dA6c935E2Ca0" 
           token_b: "0xdef1ca1fb7fbcdc777520aa7f396b4e015f497ab"
           lp_token: "0x9bd702e05b9c97e4a4a3e47df1e0fe7a0c26d2f1"
           weight_a: "0x0de0b6b3a7640000"
           weight_b: "0x0de0b6b3a7640000"
           fee: "0x0"
        creation_tx: "0xbedc6a4b23aadc836f76001c0feac79c3603719269e917e53afae22debaddb12"
        skip_simulation: false
        skip_execution: true 

      - id: "0xfec04c31b6099ce76c4c5d6d754a34141884fd91"
        tokens:
          - "0x6810e776880c02933d47db1b9fc05908e5386b96"
          - "0x7f39c581f595b53c5cb19bd0b3f8da6c935e2ca0"
          - "0xfec04c31b6099ce76c4c5d6d754a34141884fd91"
        static_attributes: 
          address: "0xfec04c31b6099ce76c4c5d6d754a34141884fd91"
          token_a:  "0x6810e776880c02933d47db1b9fc05908e5386b96"
          token_b:  "0x7f39c581f595b53c5cb19bd0b3f8da6c935e2ca0"
          lp_token: "0xfec04c31b6099ce76c4c5d6d754a34141884fd91"
          weight_b: "0x0de0b6b3a7640000"
          weight_a: "0x0de0b6b3a7640000"
          fee:      "0x00"
        creation_tx: "0xdf6f141bdd44ef389c9418992ab854567192e25eec7f2bfe4f2057b4e3e9a4de"
        skip_simulation: false 
        # Execution happens differently and is in a separate repo because the order needs to be posted to the orderbook 
        # via cow protocol
        skip_execution: true