substreams_yaml_path: ./substreams.yaml
protocol_type_names:
  - "balancer_v3_pool"
adapter_contract: "BalancerV3SwapAdapter"
adapter_build_signature: "constructor(address,address,address,address)"
adapter_build_args: "0xbA1333333333a1BA1108E8412f11850A5C319bA9,0x136f1EFcC3f8f88516B9E94110D56FDBfB1778d1,0x000000000022D473030F116dDEE9F6B43aC78BA3,0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"
skip_balance_check: true # Skipped because this Balancer V3 uses a Vault, the current version of the testing module doesn't support this.

# vault address for v3 needed for the router contract
initialized_accounts:
  - "0xbA1333333333a1BA1108E8412f11850A5C319bA9"

tests:
  - name: test_stable_pool
    start_block: 21374757
    stop_block: 21374777
    expected_components:
      - id: "0xc4ce391d82d164c166df9c8336ddf84206b2f812"
        tokens:
          - "0x0FE906e030a44eF24CA8c7dC7B7c53A6C4F00ce9"
          - "0x775F661b0bD1739349b9A2A3EF60be277c5d2D29"
        static_attributes:
          manual_updates: "0x01"
          pool_type: "0x537461626c65506f6f6c466163746f7279"
          bpt: "0xc4ce391d82d164c166df9c8336ddf84206b2f812"
          fee: "0x5af3107a4000"
          rate_providers: "0x5b22307866346235643163323266333561343630623931656464376633336365666536313965326661616634222c22307863646161363863653332323732386665343138356136306631303363313934663165326334376263225d"
          mapping_tokens: "0x5b7b22616464726573736573223a5b5b3139322c34322c3137302c35372c3137382c33352c3235342c3134312c31302c31342c39322c37392c33392c3233342c3231372c382c36302c3131372c3130382c3139345d5d2c22746f6b656e5f74797065223a22556e6465726c79696e67227d2c7b22616464726573736573223a5b5b3132372c35372c3139372c3132392c3234352c3134392c3138312c36302c39322c3137372c3135352c3230382c3137392c3234382c3231382c3130382c3134372c39342c34342c3136305d5d2c22746f6b656e5f74797065223a22556e6465726c79696e67227d5d"
        skip_simulation: false
        creation_tx: "0xecfe638ea155e78ca2698bea0bee5f86c2f77abe3e9dc93ed19ab6e674165b95"

  - name: test_weighted_pool_creation
    start_block: 21701410
    stop_block: 21701420
    expected_components:
      - id: "0x4Fd081923824D6AbdaCc862d8449e124A8634b12"
        tokens:
          - "0x249ca82617ec3dfb2589c4c17ab7ec9765350a18"
          - "0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2"
        static_attributes:
          manual_updates: "0x01"
          normalized_weights: "0x5b22307830623161326263326563353030303030222c22307830326336386166306262313430303030225d"
          fee: "0x038d7ea4c68000"
          mapping_tokens: "0x5b7b22616464726573736573223a5b5d2c22746f6b656e5f74797065223a224e6f6e65227d2c7b22616464726573736573223a5b5b33352c3131332c3232352c35322c3232372c36392c39342c352c3134372c35342c36302c3139312c3133372c3231312c3138322c3230372c38332c3131362c362c32345d2c5b31352c3233332c362c3232342c34382c3136342c37382c3234322c37362c3136382c3139392c3232302c3132332c3132342c38332c3136362c3139362c3234302c31322c3233335d2c5b3134342c38352c32382c32332c3134392c35372c33322c3134382c3235342c3130392c34312c3138332c38382c3233362c3230352c33352c36302c3235302c3136322c39365d2c5b3138372c33342c3231332c3135352c3131352c3231352c3136362c3234332c3136382c3136382c35382c33332c37352c3233362c3139382c3132362c3137392c3138312c31372c3235345d2c5b3231372c3136342c36362c3133332c3130382c33352c37342c35372c3136382c32362c382c3135362c362c36392c33302c3138362c3136342c34382c3130362c3131345d2c5b33302c3131312c3235302c37382c3135392c39392c3230392c31312c3133362c33322c3136332c3137312c38322c38362c3130362c3234382c3132392c3231382c3138312c36305d2c5b31312c3235322c3135372c38342c3235322c32342c36392c32342c3136382c31372c39382c3234382c3235312c3135332c3139342c3233342c3230322c382c31382c325d5d2c22746f6b656e5f74797065223a2257726170706564227d5d"
          pool_type: "0x5765696768746564506f6f6c466163746f7279"
        skip_simulation: true # This test is only for creation, simulation tests are below
        creation_tx: "0xaf0f8da4b7b148f156605673c6ac56657f67c47001aadd5b3b64d6cb787daad4"

  - name: test_erc4626_pool_creation # stable pool
    start_block: 21375196
    stop_block: 21375216
    expected_components:
      - id: "0x89BB794097234E5E930446C0CeC0ea66b35D7570"
        tokens:
          - "0x7bc3485026ac48b6cf9baf0a377477fff5703af8"
          - "0xd4fa2d31b7968e448877f69a96de69f5de8cd23e"
        static_attributes:
          manual_updates: "0x01"
          pool_type: "0x537461626c65506f6f6c466163746f7279"
          bpt: "0x89bb794097234e5e930446c0cec0ea66b35d7570"
          fee: "0x2d79883d2000"
          rate_providers: "0x5b22307865646636336363653462613730636265373430363462373638373838326537316562623065393838222c22307838663465383433396239373033363336343834323163363932646438393766623963306264316439225d"
          mapping_tokens: "0x5b7b22616464726573736573223a5b5b3231382c3139332c3132372c3134392c3134312c34362c3232392c33352c3136322c33322c39382c362c3135332c36392c3135312c3139332c36312c3133312c33302c3139395d5d2c22746f6b656e5f74797065223a22556e6465726c79696e67227d2c7b22616464726573736573223a5b5b3136302c3138342c3130352c3134352c3139382c33332c3133392c35342c3139332c3230392c3135372c37342c34362c3135382c3137362c3230362c35342c362c3233352c37325d5d2c22746f6b656e5f74797065223a22556e6465726c79696e67227d5d"
        skip_simulation: false
        creation_tx: "0x536baa8f18a5f9e32b08f695593f47d996a509edc886ccab6f89b001f2d2b4e4"

  - name: test_swap_g_usdc # weighted pool
    start_block: 21389576
    stop_block: 21389676
    expected_components:
      - id: "0xf91c11BA4220b7a72E1dc5E92f2b48D3fdF62726"
        tokens:
          - "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"
          - "0x440017A1b021006d556d7fc06A54c32E42Eb745B"
        static_attributes:
          pool_type: "0x5765696768746564506f6f6c466163746f7279"
          manual_updates: "0x01"
          normalized_weights: "0x5b22307830366630356235396433623230303030222c22307830366630356235396433623230303030225d"
          fee: "0x0aa87bee538000"
          mapping_tokens: "0x5b7b22616464726573736573223a5b5d2c22746f6b656e5f74797065223a224e6f6e65227d2c7b22616464726573736573223a5b5b3139302c3233392c312c3131352c39322c31392c34322c3231382c37302c3137302c3135342c3136342c3139372c37302c33352c3230322c3136392c34322c3130302c3230335d2c5b3131342c342c3138332c3231392c3234392c36352c33372c3130332c3133312c38362c35312c3138322c3234302c31322c36322c3232302c35382c3134312c39392c34385d2c5b3231322c3235302c34352c34392c3138332c3135302c3134322c36382c3133362c3131392c3234362c3135342c3135302c3232322c3130352c3234352c3232322c3134302c3231302c36325d5d2c22746f6b656e5f74797065223a2257726170706564227d5d"
        skip_simulation: false
        creation_tx: "0x50a58ca41af90029a67bc7f4305cceb1e85800246f9c559fa74d8625ddfe14ed"

  - name: test_obs_weth # weighted pool
    start_block: 21420490
    stop_block: 21420516
    expected_components:
      - id: "0x4403a2721A9A9956584dc19F553720CEf0Df35b0"
        tokens:
          - "0xafd9268fdfebee905f7439b12c943bc18ad293c2"
          - "0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2"
        static_attributes:
          pool_type: "0x5765696768746564506f6f6c466163746f7279"
          manual_updates: "0x01"
          normalized_weights: "0x5b22307830646264326663313337613330303030222c2230783233383666323666633130303030225d"
          fee: "0x038d7ea4c68000"
          mapping_tokens: "0x5b7b22616464726573736573223a5b5d2c22746f6b656e5f74797065223a224e6f6e65227d2c7b22616464726573736573223a5b5b31312c3235322c3135372c38342c3235322c32342c36392c32342c3136382c31372c39382c3234382c3235312c3135332c3139342c3233342c3230322c382c31382c325d2c5b3134342c38352c32382c32332c3134392c35372c33322c3134382c3235342c3130392c34312c3138332c38382c3233362c3230352c33352c36302c3235302c3136322c39365d2c5b33302c3131312c3235302c37382c3135392c39392c3230392c31312c3133362c33322c3136332c3137312c38322c38362c3130362c3234382c3132392c3231382c3138312c36305d2c5b3138372c33342c3231332c3135352c3131352c3231352c3136362c3234332c3136382c3136382c35382c33332c37352c3233362c3139382c3132362c3137392c3138312c31372c3235345d2c5b3231372c3136342c36362c3133332c3130382c33352c37342c35372c3136382c32362c382c3135362c362c36392c33302c3138362c3136342c34382c3130362c3131345d2c5b33352c3131332c3232352c35322c3232372c36392c39342c352c3134372c35342c36302c3139312c3133372c3231312c3138322c3230372c38332c3131362c362c32345d2c5b31352c3233332c362c3232342c34382c3136342c37382c3234322c37362c3136382c3139392c3232302c3132332c3132342c38332c3136362c3139362c3234302c31322c3233335d5d2c22746f6b656e5f74797065223a2257726170706564227d5d"
        skip_simulation: false
        creation_tx: "0x8540c2bfbc16dc2db44bc96dd32c2901eb2080d27f959b5831d96cd99903523e"

  - name: test_tbc_verse
    start_block: 21722567
    stop_block: 21722950
    expected_components:
      - id: "0x82074b99f3E927658BcAFd81F9948d89192CDF91"
        tokens:
          - "0x18084fba666a33d37592fa2633fd49a74dd93a88"
          - "0x249ca82617ec3dfb2589c4c17ab7ec9765350a18"
        static_attributes:
          pool_type: "0x5765696768746564506f6f6c466163746f7279"
          manual_updates: "0x01"
          normalized_weights: "0x5b22307830326336386166306262313430303030222c22307830623161326263326563353030303030225d"
          fee: "0x038d7ea4c68000"
          mapping_tokens: "0x5b7b22616464726573736573223a5b5d2c22746f6b656e5f74797065223a224e6f6e65227d2c7b22616464726573736573223a5b5d2c22746f6b656e5f74797065223a224e6f6e65227d5d"
        skip_simulation: false
        creation_tx: "0x214064cfcf41f7b94b4f9cdd35644b851e19ba246822b7d8f2bdcc3d6c06074e"
